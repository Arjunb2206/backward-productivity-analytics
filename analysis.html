<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RCA - Backward Analytics</title>
    <!-- Updated to latest stable Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --slate-50: #f8fafc; --slate-100: #f1f5f9; --slate-200: #e2e8f0; 
            --slate-700: #334155; --slate-800: #1e293b;
            --red-600: #dc2626; --blue-600: #2563eb;
            --gemini-gradient: linear-gradient(135deg, #4285f4 0%, #9b51e0 50%, #e91e63 100%);
        }
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; background: var(--slate-50); color: var(--slate-800); margin: 0; }
        .container { max-width: 1300px; margin: 0 auto; padding: 2rem; }
        
        /* Fixed Header */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        
        /* Gemini Box with Dynamic Content Styling */
        .gemini-box { 
            background: var(--gemini-gradient); 
            border-radius: 16px; 
            padding: 2px; 
            margin-bottom: 2rem;
            box-shadow: 0 10px 25px -5px rgba(155, 81, 224, 0.2);
        }
        .gemini-content { 
            background: white; 
            padding: 1.5rem; 
            border-radius: 14px; 
            display: flex; 
            gap: 1.5rem; 
            align-items: flex-start; 
        }
        .ai-icon { 
            width: 45px; height: 45px; border-radius: 12px; 
            background: var(--gemini-gradient); 
            color: white; display: flex; align-items: center; justify-content: center; 
            flex-shrink: 0; font-size: 1.5rem;
        }
        .gemini-text h3 { margin: 0; font-size: 1.1rem; background: var(--gemini-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .gemini-summary { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 0.5rem; }
        .summary-part b { color: var(--slate-800); }
        .summary-part p { margin: 5px 0 0 0; font-size: 0.95rem; color: var(--slate-700); line-height: 1.5; }

        /* Grid Layout */
        .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 1.5rem; }
        .card { background: white; border-radius: 12px; border: 1px solid var(--slate-200); overflow: hidden; }
        .card-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--slate-200); font-weight: 700; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .card-body { padding: 1.5rem; }

        /* RCA Tags */
        .rca-item { border-left: 4px solid var(--red-600); background: #fff1f2; padding: 1rem; margin-bottom: 1rem; border-radius: 0 8px 8px 0; }
        .rca-item.warning { border-left-color: #f59e0b; background: #fffbeb; }
        
        /* Table Styling */
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 12px; background: var(--slate-100); font-size: 0.75rem; color: #64748b; }
        td { padding: 12px; border-bottom: 1px solid var(--slate-200); font-size: 0.9rem; }
        .variance-neg { color: var(--red-600); font-weight: 600; }
        
        .btn { padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid var(--slate-200); cursor: pointer; background: white; font-weight: 500; transition: 0.2s; }
        .btn:hover { background: var(--slate-50); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button onclick="window.history.back()" class="btn">← Back to Dashboard</button>
            <h1 style="margin:0; font-size: 1.75rem;">Root Cause Analysis</h1>
        </div>

        <!-- Gemini Intelligence Box -->
        <div class="gemini-box">
            <div class="gemini-content">
                <div class="ai-icon">✦</div>
                <div class="gemini-text" style="flex: 1;">
                    <h3>Gemini Project Intelligence Summary</h3>
                    <div class="gemini-summary">
                        <div class="summary-part">
                            <b>Project Status:</b>
                            <p>The program has encountered a total <b>14-day variance</b> from the original baseline. While initial phases started on track, technical friction emerged during the transition from Design to Development.</p>
                        </div>
                        <div class="summary-part">
                            <b>Primary Delay Cause:</b>
                            <p>The critical path was impacted primarily by a <b>Resource Bottleneck</b> in the Development stage (+8 days) and <b>Logic Refactoring</b> during QA (+4 days), necessitating a schedule re-baseline.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid">
            <!-- Timeline Chart -->
            <div class="card" style="grid-column: span 8;">
                <div class="card-header" style="color: var(--red-600)">Delay Trajectory (Baseline vs Actual)</div>
                <div class="card-body">
                    <canvas id="rcaChart" height="140"></canvas>
                </div>
            </div>

            <!-- Side Drivers -->
            <div class="card" style="grid-column: span 4;">
                <div class="card-header">Major Impact Drivers</div>
                <div class="card-body">
                    <div class="rca-item">
                        <strong>Development Resources</strong><br>
                        <small>+8 Days (Bottleneck Impact)</small>
                    </div>
                    <div class="rca-item" style="border-left-color: #9b51e0; background: #f5f3ff;">
                        <strong>QA Refactoring</strong><br>
                        <small>+4 Days (Quality Spillover)</small>
                    </div>
                    <div class="rca-item warning">
                        <strong>Scope Creep</strong><br>
                        <small>+2 Days (Design Phase)</small>
                    </div>
                </div>
            </div>

            <!-- Task Analysis Table -->
            <div class="card" style="grid-column: span 12;">
                <div class="card-header">Backward Task Tracing & Source Logic</div>
                <table>
                    <thead>
                        <tr>
                            <th>Development Stage</th>
                            <th>Baseline Duration</th>
                            <th>Actual Duration</th>
                            <th>Variance</th>
                            <th>Root Cause Category (AI Identified)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><b>Design Phase</b></td>
                            <td>10 Days</td>
                            <td>12 Days</td>
                            <td class="variance-neg">+2 Days</td>
                            <td>Scope Creep (Late Requirement Changes)</td>
                        </tr>
                        <tr>
                            <td><b>Development</b></td>
                            <td>20 Days</td>
                            <td>28 Days</td>
                            <td class="variance-neg">+8 Days</td>
                            <td>Resource Bottleneck (Key Talent Unavailable)</td>
                        </tr>
                        <tr>
                            <td><b>QA Testing</b></td>
                            <td>5 Days</td>
                            <td>9 Days</td>
                            <td class="variance-neg">+4 Days</td>
                            <td>Logic Refactoring (Complexity Underestimated)</td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr style="background: #f8fafc; font-weight: bold;">
                            <td colspan="3" style="text-align: right;">Total Program Delay:</td>
                            <td class="variance-neg">+14 Days</td>
                            <td>-</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>

    <script>
        const ctx = document.getElementById('rcaChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'],
                datasets: [
                    { 
                        label: 'Baseline Schedule', 
                        data: [2, 5, 8, 12, 15], 
                        borderColor: '#cbd5e1', 
                        borderDash: [5,5],
                        tension: 0.1 
                    },
                    { 
                        label: 'Actual Progress', 
                        data: [2, 7, 13, 22, 29], 
                        borderColor: '#dc2626', 
                        borderWidth: 3,
                        pointBackgroundColor: '#dc2626',
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top', align: 'end' }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Cumulative Days' }
                    }
                }
            }
        });
    </script>
</body>
</html>

